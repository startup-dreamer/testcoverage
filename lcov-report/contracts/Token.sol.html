<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts\Token.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> Token.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">92.11% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>35/38</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">53.85% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>28/52</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>21/21</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">92.31% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>60/65</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-yes">45×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: UNLICENSED
pragma solidity 0.8.12;
&nbsp;
import "contracts/ERC20Modified.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
&nbsp;
contract Token is ERC20, Ownable {
    bool public limited; // Whether trading is limited
    bool public isTradingEnabled; // Whether trading is enabled
    uint256 public maxTokenHolding; // Maximum token holding limit for each user
    uint256 public minTokenHolding; // Minimum token holding limit for each user
    uint256 public taxCap; // Maximum tax amount
    address private taxWallet; // Address to receive tax payments
    address public uniswapV2Pair;
    mapping(address =&gt; bool) private blacklistUser; // Blacklisted addresses
    mapping(address =&gt; bool) private whitelistUser;
    mapping(address =&gt; uint256) public userTax; // Tax amount paid by each user
    bool public isTaxDisabled; // Whether taxes are disabled
    uint16 public taxRate; // Tax rate on buy transactions (in basis points)
    uint16 public claimPercentage; // Percentage of tax to claim (in basis points)
    uint256 public initializationTime;
    uint256 constant firstHourWindow = 1 hours;
    uint256 constant taxClaimConstraint = 5 hours;
&nbsp;
    modifier tradingEnabled() {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(isTradingEnabled, "Trading is currently disabled.");
        _;
    }
&nbsp;
    constructor(
        string memory name_,
        string memory symbol_,
        uint256 totalSupply_,
        address uniswapV2Pair_,
        uint256 taxCap_
    ) ERC20(name_, symbol_) {
        _mint(msg.sender, totalSupply_);
        uniswapV2Pair = uniswapV2Pair_;
        isTradingEnabled = true;
        taxCap = taxCap_;
        taxRate = 0;
        taxWallet = msg.sender;
        isTaxDisabled = false;
    }
&nbsp;
    function setTradingStatus(bool status_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        isTradingEnabled = status_;
    }
&nbsp;
    function setTaxRate(uint16 newTaxRate_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(newTaxRate_ &lt;= 3000, "Buy tax rate exceeds the maximum allowed (30%)");
        taxRate = newTaxRate_;
    }
&nbsp;
    function setClaimPercentage(uint16 claimPercentage_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(claimPercentage_ &lt;= 10000, "Claim percentage exceeds the maximum allowed (100%)");
        claimPercentage = claimPercentage_;
    }
&nbsp;
    function initializeAirdrop() external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        initializationTime = block.timestamp;
    }
&nbsp;
    function setRule(
        bool limited_,
        uint256 maxTokenHolding_,
        uint256 minTokenHolding_,
        uint256 taxCap_
    ) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        limited = limited_;
        maxTokenHolding = maxTokenHolding_;
        minTokenHolding = minTokenHolding_;
        taxCap = taxCap_;
    }
&nbsp;
    function disableTaxes(bool isTaxDisabled_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        isTaxDisabled = isTaxDisabled_;
    }
&nbsp;
    function _transfer(
        address sender_,
        address recipient_,
        uint256 amount_
    ) internal virtual override <span class="missing-if-branch" title="else path not taken" >E</span>tradingEnabled {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(sender_ != address(0), "ERC20: transfer from the zero address");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(recipient_ != address(0), "ERC20: transfer to the zero address");
&nbsp;
        if (isTaxDisabled) {
            // Taxes are disabled, no tax calculation needed
            _beforeTokenTransfer(sender_, recipient_, amount_);
&nbsp;
            _tokenTransfer(sender_, recipient_, amount_, 0);
&nbsp;
            _afterTokenTransfer(sender_, recipient_, amount_);
&nbsp;
        } else {
            _beforeTokenTransfer(sender_, recipient_, amount_);
&nbsp;
            // Apply tax rate
            uint256 taxAmount = _calculateTax(amount_);
&nbsp;
            if (_isBuyTransfer(recipient_) &amp;&amp; (block.timestamp &lt; initializationTime + firstHourWindow)) {
                // recipient will get to reclaim as the tax is deducted from their share
                whitelistUser[recipient_] = true;
                userTax[recipient_] += taxAmount;
            }
&nbsp;
            <span class="missing-if-branch" title="if path not taken" >I</span>if (!_isBuyTransfer(recipient_) &amp;&amp; block.timestamp &lt; initializationTime + taxClaimConstraint) {
                whitelistUser[recipient_] = false;
            }
&nbsp;
            _tokenTransfer(sender_, recipient_, amount_, taxAmount);
&nbsp;
            _afterTokenTransfer(sender_, recipient_, amount_);
        }
&nbsp;
        emit Transfer(sender_, recipient_, amount_);
    }
&nbsp;
    // Calculates tax based on amount and tax rate.
    function _calculateTax(uint256 amount_) internal view returns (uint256) {
        uint256 taxAmount = (amount_ * taxRate) / 10000;
        <span class="missing-if-branch" title="if path not taken" >I</span>if (taxAmount &gt; taxCap) {
            taxAmount = taxCap;
        }
        return taxAmount;
    }
&nbsp;
    function _tokenTransfer(
        address sender_,
        address recipient_,
        uint256 amount_,
        uint256 taxAmount_
    ) internal {
        uint256 senderBalance = _balances[sender_];
        <span class="missing-if-branch" title="else path not taken" >E</span>require(senderBalance &gt;= amount_, "ERC20: transfer amount exceeds balance");
        unchecked {
            _balances[sender_] = senderBalance - amount_;
            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by
            // decrementing then incrementing.
            _balances[recipient_] += amount_ - taxAmount_;
        }
    }
&nbsp;
    // Whether the transfer is a buy transaction or sell transaction.
    function _isBuyTransfer(address recipient_) internal view returns (bool) {
        return recipient_ == uniswapV2Pair ? <span class="missing-if-branch" title="if path not taken" >I</span>false : true;
    }
&nbsp;
    function blacklist(address address_, bool isBlacklisting_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        blacklistUser[address_] = isBlacklisting_;
    }
&nbsp;
    function removeBlacklist(address address_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        blacklistUser[address_] = false;
    }
&nbsp;
    function isBlacklisted(address address_) public view returns (bool) {
        return blacklistUser[address_];
    }
&nbsp;
    function isWhitelisted(address address_) public view returns (bool) {
        return whitelistUser[address_];
    }
&nbsp;
    function _removeWhitelist(address address_) internal {
        whitelistUser[address_] = false;
        userTax[address_] = 0;
    }
&nbsp;
    function _beforeTokenTransfer(
        address from_,
        address to_,
        uint256 amount_
    ) internal virtual override {
        require(!blacklistUser[to_] &amp;&amp; !blacklistUser[from_], "Blacklisted");
        <span class="missing-if-branch" title="if path not taken" >I</span>if (limited) {
<span class="cstat-no" title="statement not covered" >            uint256 recipientBalance = super.balanceOf(to_);</span>
<span class="cstat-no" title="statement not covered" >            uint256 newBalance = recipientBalance + amount_;</span>
<span class="cstat-no" title="statement not covered" >            require(newBalance &lt;= maxTokenHolding &amp;&amp; newBalance &gt;= minTokenHolding, "Forbid")</span>;
        }
    }
&nbsp;
    function burn(uint256 value_) external {
        _burn(msg.sender, value_);
    }
&nbsp;
    // mint to Replenish tokens in pool
    function mint(uint256 amount_) external <span class="missing-if-branch" title="else path not taken" >E</span>onlyOwner {
        _mint(msg.sender, amount_);
    }
&nbsp;
    function claimTokens() external {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(whitelistUser[msg.sender], "Not eligible for tax claim");
        uint256 taxPaid = userTax[msg.sender];
        uint256 tokensToClaim = (taxPaid * claimPercentage) / 10000;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(tokensToClaim &gt; 0, "No tokens to claim");
&nbsp;
        _removeWhitelist(msg.sender);
        _mint(msg.sender, tokensToClaim);
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Jul 17 2023 19:56:09 GMT+0530 (India Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
